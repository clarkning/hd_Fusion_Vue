webpackJsonp([20],{"8Zfg":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i("wT6d"),s=i.n(r),a={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"SellProduct"},[i("sellProgress"),e._v(" "),i("div",{staticClass:"m_t",on:{touchmove:function(e){e.stopPropagation()}}},[i("div",{directives:[{name:"show",rawName:"v-show",value:e.showOrHide.existPurchaseTime&&!e.showOrHide.isHardwareProducts,expression:"showOrHide.existPurchaseTime && !showOrHide.isHardwareProducts"}],staticClass:"bg_img_none",on:{click:function(t){e.openPicker()}}},[i("mt-field",{attrs:{label:"购机日期:",placeholder:"请输入购机日期",type:"text",readonly:!0,disableClear:!0},model:{value:e.timePicker.viewDate,callback:function(t){e.$set(e.timePicker,"viewDate",t)},expression:"timePicker.viewDate"}})],1),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:!e.showOrHide.isHardwareProducts,expression:"!showOrHide.isHardwareProducts"}],staticClass:"bg_img_none",class:{m_t15:e.showOrHide.existPurchaseTime&&!e.showOrHide.isHardwareProducts},attrs:{id:"price"}},[i("mt-field",{attrs:{label:"购机价格(元):",placeholder:"请输入购机价格",type:"tel"},model:{value:e.purchasePrice,callback:function(t){e.purchasePrice=t},expression:"purchasePrice"}})],1),e._v(" "),i("div",{staticClass:"overflow_y",class:{List:e.listScroll,listTime:e.listTimeScroll,m_t15:e.listScroll||e.listTimeScroll}},[e.serviceOptionItem.showList?i("div",{staticClass:"null_data"},[i("div",{staticClass:"null"}),e._v(" "),i("p",[e._v("暂无符合条件的产品服务")])]):i("div",e._l(e.serviceOptionItem.list,function(t){return i("div",{staticClass:"item_container",on:{click:function(i){e.goToPagePayList(t.serviceOptionItemId,t.licenceId)}}},[i("div",{staticClass:"item_p"},[i("div",{staticClass:"item_img"},[i("img",{attrs:{src:t.imageUrl}})]),e._v(" "),i("div",{staticClass:"item_content"},[i("p",{staticClass:"item_over popup_color3"},[e._v(e._s(t.name))]),e._v(" "),i("p",{staticClass:"popup_color8"},[e._v("累计销售 "+e._s(t.sale)+" 份")]),e._v(" "),i("button",{staticClass:"item_button item_color",on:{click:function(i){i.stopPropagation(),e.goToPageProductDescription(e.params.servicePackId,t.licenceId)}}},[e._v("产品介绍\n              ")]),e._v(" "),i("button",{staticClass:"item_button item_color",on:{click:function(i){i.stopPropagation(),e.goToPageProductDescription(e.params.servicePackId,t.licenceId,!0)}}},[e._v("\n                服务条款\n              ")])]),e._v(" "),i("div",{staticClass:"item_price item_font14"},[e._v(e._s(t.unitPrice)+"元")]),e._v(" "),i("div",{staticClass:"item_link"})])])}))])]),e._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:e.showOrHide.existPurchaseTime&&!e.showOrHide.isHardwareProducts,expression:"showOrHide.existPurchaseTime && !showOrHide.isHardwareProducts"}],on:{touchmove:function(e){e.preventDefault()}}},[i("mt-datetime-picker",{ref:"picker",staticClass:"timePicker",attrs:{"lock-scroll":"true",type:"date",endDate:e.timePicker.maxDate,"year-format":"{value} "},on:{confirm:e.handleConfirm},model:{value:e.timePicker.pickerValue,callback:function(t){e.$set(e.timePicker,"pickerValue",t)},expression:"timePicker.pickerValue"}})],1)],1)},staticRenderFns:[]},c=function(e){i("Z/Gb")},n=i("VU/8")(s.a,a,!1,c,"data-v-6a595352",null);t.default=n.exports},"Z/Gb":function(e,t){},wT6d:function(e,t,i){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var s=r(i("Dd8w")),a=r(i("Xxa5")),c=r(i("exGp")),n=r(i("3D1+")),o=r(i("PJh5")),u=r(i("31Wn")),l=r(i("M4fF")),d=i("JaHG"),p=(0,i("NYxO").createNamespacedHelpers)("order"),h=p.mapState,m=p.mapMutations;t.default={name:"SellProduct",components:{sellProgress:u.default},data:function(){return{sellTips:!0,showOrHide:{existPurchaseTime:"",isHardwareProducts:!0},params:{servicePackId:null,storeId:null,projectId:null},timePicker:{pickerValue:(0,o.default)().toDate(),viewDate:null,purchaseTime:null,maxDate:(0,o.default)().toDate()},purchasePrice:"",serviceOptionItem:{list:[],showList:!1},pushName:this.$route.meta.pushName}},created:function(){var e=(0,c.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.params.servicePackId=this.$route.query.servicePackId,this.params.storeId=this.$route.query.storeId,this.params.projectId=this.$route.query.projectId,this.timePicker.viewDate=this.storeOrderFilling.viewDate,this.purchasePrice=this.storeOrderFilling.purchasePrice,this.timePicker.purchaseTime=this.storeOrderFilling.purchaseTime,e.next=8,this.loadHardwareProduct();case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),mounted:function(){var e=(0,c.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.addTitle(),this.timePicker.viewDate||this.openPicker();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),beforeRouteLeave:function(e,t,i){var r={viewDate:this.timePicker.viewDate,purchasePrice:this.purchasePrice,purchaseTime:this.timePicker.purchaseTime};this.setSellProduct(r),i()},methods:(0,s.default)({},m(["setSellProduct"]),{addTitle:function(){document.getElementsByClassName("picker-toolbar")[0].insertAdjacentHTML("beforeBegin",'<div class="datetime_title">请选择购机日期</div>')},loadHardwareProduct:function(){var e=(0,c.default)(a.default.mark(function e(){var t=this;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,d.loadData)(function(){return n.default.getServicePack(t.params.servicePackId)},function(e){t.showOrHide.existPurchaseTime=e.existPurchaseTime,t.showOrHide.isHardwareProducts=e.isHardwareProducts,!0===t.showOrHide.isHardwareProducts&&t.getServiceOptionItems()},d.defaultPreHandler,!0);case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),executeLoadingProducts:l.default.debounce((0,c.default)(a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.timePicker.purchaseTime&&this.purchasePrice||!this.showOrHide.isHardwareProducts&&!this.showOrHide.existPurchaseTime)){e.next=6;break}return e.next=3,this.getServiceOptionItems();case 3:""===this.purchasePrice&&(this.sellTips=!0,this.serviceOptionItem.list=[],this.serviceOptionItem.showList=!1),e.next=9;break;case 6:this.sellTips=!0,this.serviceOptionItem.list=[],this.serviceOptionItem.showList=!1;case 9:case"end":return e.stop()}},e,this)})),300),openPicker:function(){this.timePicker.purchaseTime&&(this.timePicker.pickerValue=(0,o.default)(this.timePicker.purchaseTime).toDate()),this.$refs.picker.open()},setDate:function(e){this.timePicker.viewDate=(0,o.default)(e).format("YYYY 年 MM 月 DD 日"),this.timePicker.purchaseTime=(0,o.default)(e).format("YYYY/MM/DD")},getServiceOptionItems:function(){var e=(0,c.default)(a.default.mark(function e(){var t,i=this;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!/^[0-9]+(.[0-9]{1,2})?$/.test(this.purchasePrice)&&this.purchasePrice){e.next=5;break}return t={servicePackId:this.params.servicePackId,purchasePrice:this.purchasePrice,purchaseTime:this.timePicker.purchaseTime},e.next=5,(0,d.loadData)(function(){return n.default.getServiceOptionItems(t)},function(){var e=(0,c.default)(a.default.mark(function e(r){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l.default.forEach(r,function(e){0===e.salesTimes&&(e.salesTimes=1);var t=e.salesBaseValue+e.salesCount*e.salesTimes;e.sale=l.default.padStart(t.toString(),6,"0")}),i.purchasePrice!==t.purchasePrice){e.next=8;break}i.serviceOptionItem.list=r,i.serviceOptionItem.list.length>0&&(i.sellTips=!1),i.serviceOptionItem.showList=0===i.serviceOptionItem.list.length,i.serviceOptionItem.showList&&(i.sellTips=!1),e.next=10;break;case 8:return e.next=10,i.getServiceOptionItems();case 10:case"end":return e.stop()}},e,i)}));return function(t){return e.apply(this,arguments)}}(),d.defaultPreHandler);case 5:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),handleConfirm:function(e){this.setDate(e),document.getElementById("price").getElementsByTagName("input")[0].focus()},goToPageProductDescription:function(e,t,i){var r={servicePackId:e,licenceId:t};i&&(r.service=1),this.$router.push({name:"ProductDescription",query:r})},goToPagePayList:function(){var e=(0,c.default)(a.default.mark(function e(t){var i;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.saveOrder(t);case 2:(i=e.sent)&&this.$router.push({name:this.pushName,query:{orderId:i.orderId}});case 4:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),saveOrder:function(){var e=(0,c.default)(a.default.mark(function e(t){var i,r;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=void 0,r={storeId:this.params.storeId,projectId:this.params.projectId,personId:this.$store.state.person.personId,purchasePrice:this.purchasePrice,purchaseTime:this.timePicker.purchaseTime,serviceOptionItemId:t},e.next=4,(0,d.loadData)(function(){return n.default.getSaveOrder(r)},function(e){i=e},d.defaultPreHandler);case 4:return e.abrupt("return",i);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}),computed:(0,s.default)({},h({storeOrderFilling:function(e){return e.orderFilling}}),{listScroll:function(){return this.showOrHide.existPurchaseTime&&!this.showOrHide.isHardwareProducts},listTimeScroll:function(){return!this.showOrHide.isHardwareProducts&&!this.showOrHide.existPurchaseTime}}),watch:{"timePicker.purchaseTime":"executeLoadingProducts",purchasePrice:"executeLoadingProducts"}}}});
//# sourceMappingURL=20.314429a124faec5383de.js.map