{"version":3,"sources":["webpack:///src/components/report/my_ach.vue","webpack:///./src/components/report/my_ach.vue?42f5","webpack:///./src/components/report/my_ach.vue"],"names":["__webpack_require__","_utils","created","_ref","_asyncToGenerator3","default","_regenerator2","mark","_callee","setQuery","setTable","_ref2","row","_ref3","_callee2","query","getSummaries","dimension","summary","data","loadTableData","personName","positionName","object","sales","defaultPreHandler","order","length","saleCol","orderCol","partnerId","projectId","organizationId","personId","tableData","property","reverse","sit","_context4","t0","report_my_ach","render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","model","value","callback","$$v","expression","attrs","id","staticStyle","width","size","table","span-method","arraySpanMethod","border","header-align","on","header-click","sortTableData","fixed","prop","label","min-width","align","default-sort","staticRenderFns","__vue_styles__","ssrContext","Component","normalizeComponent","my_ach_default","a","__webpack_exports__"],"mappings":"gNA4DAA,EAAA,aACAA,EAAA,aACAA,EAAA,SAGAC,EAAAD,EAAA,wBAEA,mCAGA,mBAEA,WACA,aACA,YACA,iBACA,WACA,qBACA,eACA,cAEA,iBACA,0BAEA,gBACA,SACA,SACA,QAEA,yDASAE,QAAA,WAhCA,IAAAC,GAAA,EAAAC,EAAAC,SAAAC,EAAAD,QAAAE,KAAA,SAAAC,sFAiCAC,yBAEAC,2GAHA,wCAKAC,EAAAC,aAAA,iDACA,mBAEA,qBAEA,KAIAF,SAAA,WAVA,IAAAG,GAAA,EAAAT,EAAAC,SAAAC,EAAAD,QAAAE,KAAA,SAAAO,mFAWA,8FAEAC,mBACAC,2DACAC,wBACAC,8BAEAC,kGARA,GASAC,cAAA,uPAEA,SAAAD,mIAKA,8EACA,iCACAE,4CACAC,wDACA,WACAC,gEAGAC,SAGAvB,EAAAwB,mHAlBA,2HAwBAD,gBACAE,6CAEAC,wCACAC,oCACAC,0FACA,4BACA,+BACA,qEAGA,qEACA,qDACAC,iDACAC,sDACAC,4DACAC,8EAGAC,yBACA,+EAEAC,kCAEAC,sBACAlB,8BACAC,2BAEA,gKAEA,yBACAD,8BACAC,kDAGAgB,wBAEAjB,8BACAC,gFAMAkB,8EACAA,SACA,iBAIA,cAJAC,EAAAC,GAIA,EAIA,UAJAD,EAAAC,GAIA,qEAPA,sEAEA,gHAEA,wDAEA,uGAEA,sEAEA,4CAGA7B,iOC1MA8B,GADiBC,OAFjB,WAA0B,IAAAC,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,YAAA,QAAkBF,EAAA,OAAYE,YAAA,WAAqBF,EAAA,OAAYE,YAAA,UAAoBN,EAAAO,GAAA,UAAAP,EAAAO,GAAA,KAAAH,EAAA,OAAyCE,YAAA,SAAmBF,EAAA,aAAkBI,OAAOC,MAAAT,EAAA,UAAAU,SAAA,SAAAC,GAA+CX,EAAAzB,UAAAoC,GAAkBC,WAAA,eAAyBR,EAAA,eAAoBS,OAAOC,GAAA,WAAcd,EAAAO,GAAA,QAAAP,EAAAO,GAAA,KAAAH,EAAA,eAA+CS,OAAOC,GAAA,eAAkBV,EAAA,OAAAJ,EAAAO,GAAA,UAAAP,EAAAO,GAAA,KAAAH,EAAA,eAA2DS,OAAOC,GAAA,WAAcd,EAAAO,GAAA,kBAAAP,EAAAO,GAAA,KAAAH,EAAA,YAAsDW,aAAaC,MAAA,QAAeH,OAAQI,KAAA,QAAAxC,KAAAuB,EAAAkB,MAAA1B,UAAA2B,cAAAnB,EAAAoB,gBAAAC,OAAA,GAAAC,eAAA,UAAgHC,IAAKC,eAAAxB,EAAAyB,iBAAkCrB,EAAA,mBAAwBS,OAAOa,MAAA,GAAAC,KAAA,aAAAC,MAAA,KAAAC,YAAA,KAAAC,MAAA,YAA+E9B,EAAAO,GAAA,KAAAH,EAAA,mBAAoCS,OAAOa,MAAA,GAAAC,KAAA,eAAAC,MAAA,KAAAC,YAAA,MAAAC,MAAA,YAAkF9B,EAAAO,GAAA,KAAAH,EAAA,mBAAoCS,OAAOc,KAAA,QAAAC,MAAA,MAAAC,YAAA,KAAAE,eAAA,mBAAAD,MAAA,WAAiG9B,EAAAO,GAAA,KAAAH,EAAA,mBAAoCS,OAAOc,KAAA,QAAAC,MAAA,MAAAC,YAAA,KAAAC,MAAA,WAA+D9B,EAAAO,GAAA,KAAAH,EAAA,mBAAoCS,OAAOc,KAAA,OAAAC,MAAA,MAAAC,YAAA,KAAAC,MAAA,YAA8D,QAEv1CE,oBCSjBC,EAXA,SAAAC,GACA5E,EAAA,SAeA6E,EAbA7E,EAAA,OAaA8E,CACAC,EAAAC,EACAxC,GATA,EAWAmC,EAPA,kBAEA,MAUAM,EAAA,QAAAJ,EAAA","file":"static/js/40.2d543926c9523047ef81.js","sourcesContent":["<template>\n  <div class=\"pay\">\n    <div class=\"header\">\n      <div class=\"title\">我的业绩</div>\n      <div class=\"w-90\">\n        <mt-navbar v-model=\"dimension\">\n          <mt-tab-item id=\"today\">今日</mt-tab-item>\n          <mt-tab-item id=\"yesterday\">\n            <div>昨日</div>\n          </mt-tab-item>\n          <mt-tab-item id=\"month\">本月</mt-tab-item>\n        </mt-navbar>\n      </div>\n    </div>\n    <el-table\n      size=\"small\"\n      :data=\"table.tableData\"\n      :span-method=\"arraySpanMethod\"\n      border\n      style=\"width: 100%\"\n      @header-click=\"sortTableData\"\n      header-align=\"center\">\n      <el-table-column\n        fixed\n        prop=\"personName\"\n        label=\"姓名\"\n        min-width=\"70\"\n        align=\"center\">\n      </el-table-column>\n      <el-table-column\n        fixed\n        prop=\"positionName\"\n        label=\"职位\"\n        min-width=\"100\"\n        align=\"center\">\n      </el-table-column>\n      <el-table-column\n        prop=\"sales\"\n        label=\"销售额\"\n        min-width=\"70\"\n        default-sort=\"order:descending\"\n        align=\"right\">\n      </el-table-column>\n      <el-table-column\n        prop=\"order\"\n        label=\"订单量\"\n        min-width=\"70\"\n        align=\"right\">\n      </el-table-column>\n      <el-table-column\n        prop=\"unit\"\n        label=\"客单价\"\n        min-width=\"70\"\n        align=\"right\">\n      </el-table-column>\n    </el-table>\n  </div>\n</template>\n\n<script>\n  import _ from 'lodash'\n  import api from '../../api/index2'\n  import moment from 'moment'\n  import { loadData, defaultPreHandler } from '../../common/utils'\n\n  export default {\n    name: 'MyAch',\n    data () {\n      return {\n        col: 0,\n        query: {\n          startTime: '',\n          endTime: '',\n          partnerId: 0,\n          projectId: 0,\n          organizationId: 0,\n          personId: 0,\n          organizationScopes: '1',\n          dimensions: '6,7',\n          results: '1,2'\n        },\n        dimension: 'today',\n        sort: {\n          personName: false,\n          positionName: false,\n          order: false,\n          sales: false,\n          unit: false\n        },\n        table: {\n          today: [],\n          yesterday: [],\n          month: [],\n          tableData: []\n        }\n      }\n    },\n    async created () {\n      this.setQuery()\n      await this.setTable()\n    },\n    methods: {\n      arraySpanMethod ({row, column, rowIndex, columnIndex}) {\n        if (rowIndex === this.col) {\n          if (columnIndex === 0) {\n            return [1, 2]\n          } else if (columnIndex === 1) {\n            return [0, 0]\n          }\n        }\n      },\n      async setTable () {\n        if (this.table[this.dimension].length === 0) {\n          await this.loadTableData(this.query)\n        }\n        this.getSummaries()\n        let data = JSON.parse(JSON.stringify(this.table[this.dimension]))\n        data.push(this.summary)\n        this.table.tableData = data\n      },\n      async loadTableData () {\n        this.table.tableData = []\n        await loadData(() => { return api.getReportForm(this.query) },\n          (data) => {\n            let tabData = []\n            _.forEach(data, (item) => {\n              let object = {}\n              object.sales = item.resultData.salesAmount ? Math.round(Number(item.resultData.salesAmount)) : 0\n              object.order = item.resultData.salesCount ? Math.round(Number(item.resultData.salesCount)) : 0\n              object.personName = item.resultDimension.personName\n              object.positionName = item.resultDimension.positionName\n              object.unit = object.order ? Math.round(object.sales / object.order) : '/'\n              tabData.push(object)\n            })\n            this.table[this.dimension] = tabData.sort(function (x, y) {\n              return y.sales - x.sales\n            })\n          }, defaultPreHandler)\n      },\n      getSummaries () {\n        this.summary = {}\n        let saleCol = []\n        let orderCol = []\n        _.forEach(this.table[this.dimension], item => {\n          saleCol.push(item.sales)\n          orderCol.push(item.order)\n        })\n        this.col = this.table[this.dimension].length\n        this.summary.sales = _.sum(saleCol)\n        this.summary.order = _.sum(orderCol)\n        this.summary.unit = this.summary.order ? Math.round(this.summary.sales / this.summary.order) : '/'\n        this.summary.personName = '总计'\n        this.summary.positionName = '/'\n      },\n      setQuery () {\n        this.query.startTime = moment().format('YYYY-MM-DD')\n        this.query.endTime = moment().add(1, 'day').format('YYYY-MM-DD')\n        this.query.partnerId = this.$route.query.partnerId\n        this.query.projectId = this.$route.query.projectId\n        this.query.organizationId = this.$route.query.organizationId\n        this.query.personId = this.$store.state.person.personId\n      },\n      sortTableData (column) {\n        let data = JSON.parse(JSON.stringify(this.table.tableData))\n        data = data.slice(0, -1)\n        let key = _.findKey(this.sort, function (v) { return v })\n        this.sort[key] = key === column.property\n        if (this.sort[column.property]) {\n          data.reverse()\n          data.push(this.summary)\n          this.table.tableData = data\n        } else {\n          this.sort[column.property] = true\n          if (column.property === 'positionName' || column.property === 'organizationName') {\n            data.sort((a, b) => a[column.property].localeCompare(b[column.property], 'zh-Hans-CN', {sensitivity: 'accent'}))\n            data.push(this.summary)\n            this.table.tableData = data\n          } else {\n            data.sort(function (x, y) {\n              return y[column.property] - x[column.property]\n            })\n            data.push(this.summary)\n            this.table.tableData = data\n          }\n        }\n      }\n    },\n    watch: {\n      'dimension': async function (sit) {\n        switch (sit) {\n          case 'today':\n            this.query.startTime = moment().format('YYYY-MM-DD')\n            this.query.endTime = moment().add(1, 'days').format('YYYY-MM-DD')\n            break\n          case 'yesterday':\n            this.query.startTime = moment().subtract(1, 'days').format('YYYY-MM-DD')\n            this.query.endTime = moment().format('YYYY-MM-DD')\n            break\n          case 'month':\n            this.query.startTime = moment().startOf('month').format('YYYY-MM-DD')\n            this.query.endTime = moment().add(1, 'days').format('YYYY-MM-DD')\n        }\n        await this.setTable()\n      }\n    }\n  }\n</script>\n<style scoped>\n  .header {\n    padding-top: 10px;\n    background: #fff;\n  }\n\n  .title {\n    border-left: 2px solid #26a2ff;\n    font-size: 14px;\n    margin-left: 15px;\n    padding-left: 10px;\n  }\n\n  .w-90 {\n    background: transparent;\n    padding: 10px 15px 0;\n    width: calc(100% - 30px);\n    overflow-x: scroll;\n  }\n\n  .mint-navbar .mint-tab-item {\n    padding: 8px 0;\n    min-width: 5rem;\n    background: #fff;\n  }\n\n  .mint-navbar .mint-tab-item.is-selected {\n    color: #26a2ff;\n    margin-bottom: 0;\n    border-bottom: 1px solid #26a2ff;\n  }\n\n  .mint-navbar {\n    background: transparent;\n  }\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/components/report/my_ach.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"pay\"},[_c('div',{staticClass:\"header\"},[_c('div',{staticClass:\"title\"},[_vm._v(\"我的业绩\")]),_vm._v(\" \"),_c('div',{staticClass:\"w-90\"},[_c('mt-navbar',{model:{value:(_vm.dimension),callback:function ($$v) {_vm.dimension=$$v},expression:\"dimension\"}},[_c('mt-tab-item',{attrs:{\"id\":\"today\"}},[_vm._v(\"今日\")]),_vm._v(\" \"),_c('mt-tab-item',{attrs:{\"id\":\"yesterday\"}},[_c('div',[_vm._v(\"昨日\")])]),_vm._v(\" \"),_c('mt-tab-item',{attrs:{\"id\":\"month\"}},[_vm._v(\"本月\")])],1)],1)]),_vm._v(\" \"),_c('el-table',{staticStyle:{\"width\":\"100%\"},attrs:{\"size\":\"small\",\"data\":_vm.table.tableData,\"span-method\":_vm.arraySpanMethod,\"border\":\"\",\"header-align\":\"center\"},on:{\"header-click\":_vm.sortTableData}},[_c('el-table-column',{attrs:{\"fixed\":\"\",\"prop\":\"personName\",\"label\":\"姓名\",\"min-width\":\"70\",\"align\":\"center\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"fixed\":\"\",\"prop\":\"positionName\",\"label\":\"职位\",\"min-width\":\"100\",\"align\":\"center\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"sales\",\"label\":\"销售额\",\"min-width\":\"70\",\"default-sort\":\"order:descending\",\"align\":\"right\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"order\",\"label\":\"订单量\",\"min-width\":\"70\",\"align\":\"right\"}}),_vm._v(\" \"),_c('el-table-column',{attrs:{\"prop\":\"unit\",\"label\":\"客单价\",\"min-width\":\"70\",\"align\":\"right\"}})],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-e36480d2\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/components/report/my_ach.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-e36480d2\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./my_ach.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./my_ach.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-e36480d2\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./my_ach.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-e36480d2\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/report/my_ach.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}