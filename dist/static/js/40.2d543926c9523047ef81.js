webpackJsonp([40],{"345G":function(t,e,a){"use strict";function r(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=r(a("mvHQ")),n=r(a("Xxa5")),i=r(a("exGp")),o=r(a("M4fF")),u=r(a("3D1+")),l=r(a("PJh5")),d=a("JaHG");e.default={name:"MyAch",data:function(){return{col:0,query:{startTime:"",endTime:"",partnerId:0,projectId:0,organizationId:0,personId:0,organizationScopes:"1",dimensions:"6,7",results:"1,2"},dimension:"today",sort:{personName:!1,positionName:!1,order:!1,sales:!1,unit:!1},table:{today:[],yesterday:[],month:[],tableData:[]}}},created:function(){var t=(0,i.default)(n.default.mark(function t(){return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.setQuery(),t.next=3,this.setTable();case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),methods:{arraySpanMethod:function(t){t.row,t.column;var e=t.rowIndex,a=t.columnIndex;if(e===this.col){if(0===a)return[1,2];if(1===a)return[0,0]}},setTable:function(){var t=(0,i.default)(n.default.mark(function t(){var e;return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0!==this.table[this.dimension].length){t.next=3;break}return t.next=3,this.loadTableData(this.query);case 3:this.getSummaries(),(e=JSON.parse((0,s.default)(this.table[this.dimension]))).push(this.summary),this.table.tableData=e;case 7:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),loadTableData:function(){var t=(0,i.default)(n.default.mark(function t(){var e=this;return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return this.table.tableData=[],t.next=3,(0,d.loadData)(function(){return u.default.getReportForm(e.query)},function(t){var a=[];o.default.forEach(t,function(t){var e={};e.sales=t.resultData.salesAmount?Math.round(Number(t.resultData.salesAmount)):0,e.order=t.resultData.salesCount?Math.round(Number(t.resultData.salesCount)):0,e.personName=t.resultDimension.personName,e.positionName=t.resultDimension.positionName,e.unit=e.order?Math.round(e.sales/e.order):"/",a.push(e)}),e.table[e.dimension]=a.sort(function(t,e){return e.sales-t.sales})},d.defaultPreHandler);case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),getSummaries:function(){this.summary={};var t=[],e=[];o.default.forEach(this.table[this.dimension],function(a){t.push(a.sales),e.push(a.order)}),this.col=this.table[this.dimension].length,this.summary.sales=o.default.sum(t),this.summary.order=o.default.sum(e),this.summary.unit=this.summary.order?Math.round(this.summary.sales/this.summary.order):"/",this.summary.personName="总计",this.summary.positionName="/"},setQuery:function(){this.query.startTime=(0,l.default)().format("YYYY-MM-DD"),this.query.endTime=(0,l.default)().add(1,"day").format("YYYY-MM-DD"),this.query.partnerId=this.$route.query.partnerId,this.query.projectId=this.$route.query.projectId,this.query.organizationId=this.$route.query.organizationId,this.query.personId=this.$store.state.person.personId},sortTableData:function(t){var e=JSON.parse((0,s.default)(this.table.tableData));e=e.slice(0,-1);var a=o.default.findKey(this.sort,function(t){return t});this.sort[a]=a===t.property,this.sort[t.property]?(e.reverse(),e.push(this.summary),this.table.tableData=e):(this.sort[t.property]=!0,"positionName"===t.property||"organizationName"===t.property?(e.sort(function(e,a){return e[t.property].localeCompare(a[t.property],"zh-Hans-CN",{sensitivity:"accent"})}),e.push(this.summary),this.table.tableData=e):(e.sort(function(e,a){return a[t.property]-e[t.property]}),e.push(this.summary),this.table.tableData=e))}},watch:{dimension:function(){var t=(0,i.default)(n.default.mark(function t(e){return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:t.t0=e,t.next="today"===t.t0?3:"yesterday"===t.t0?6:"month"===t.t0?9:11;break;case 3:return this.query.startTime=(0,l.default)().format("YYYY-MM-DD"),this.query.endTime=(0,l.default)().add(1,"days").format("YYYY-MM-DD"),t.abrupt("break",11);case 6:return this.query.startTime=(0,l.default)().subtract(1,"days").format("YYYY-MM-DD"),this.query.endTime=(0,l.default)().format("YYYY-MM-DD"),t.abrupt("break",11);case 9:this.query.startTime=(0,l.default)().startOf("month").format("YYYY-MM-DD"),this.query.endTime=(0,l.default)().add(1,"days").format("YYYY-MM-DD");case 11:return t.next=13,this.setTable();case 13:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()}}},"ZX+S":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("345G"),s=a.n(r),n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pay"},[a("div",{staticClass:"header"},[a("div",{staticClass:"title"},[t._v("我的业绩")]),t._v(" "),a("div",{staticClass:"w-90"},[a("mt-navbar",{model:{value:t.dimension,callback:function(e){t.dimension=e},expression:"dimension"}},[a("mt-tab-item",{attrs:{id:"today"}},[t._v("今日")]),t._v(" "),a("mt-tab-item",{attrs:{id:"yesterday"}},[a("div",[t._v("昨日")])]),t._v(" "),a("mt-tab-item",{attrs:{id:"month"}},[t._v("本月")])],1)],1)]),t._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{size:"small",data:t.table.tableData,"span-method":t.arraySpanMethod,border:"","header-align":"center"},on:{"header-click":t.sortTableData}},[a("el-table-column",{attrs:{fixed:"",prop:"personName",label:"姓名","min-width":"70",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{fixed:"",prop:"positionName",label:"职位","min-width":"100",align:"center"}}),t._v(" "),a("el-table-column",{attrs:{prop:"sales",label:"销售额","min-width":"70","default-sort":"order:descending",align:"right"}}),t._v(" "),a("el-table-column",{attrs:{prop:"order",label:"订单量","min-width":"70",align:"right"}}),t._v(" "),a("el-table-column",{attrs:{prop:"unit",label:"客单价","min-width":"70",align:"right"}})],1)],1)},staticRenderFns:[]},i=function(t){a("cIkf")},o=a("VU/8")(s.a,n,!1,i,"data-v-e36480d2",null);e.default=o.exports},cIkf:function(t,e){}});
//# sourceMappingURL=40.2d543926c9523047ef81.js.map