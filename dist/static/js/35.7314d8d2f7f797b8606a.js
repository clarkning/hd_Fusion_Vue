webpackJsonp([35],{XaEr:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("e5fO"),i=r.n(a),s={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"hbSellProduct SellProduct bg_img_none"},[r("div",{staticClass:"header"},[e._v("匹配可售产品")]),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.showOrHide.existPurchaseTime&&!e.showOrHide.isHardwareProducts,expression:"showOrHide.existPurchaseTime && !showOrHide.isHardwareProducts"}],on:{click:function(t){e.openPicker()}}},[r("mt-field",{attrs:{label:"购机日期:",placeholder:"请选择购机日期",type:"text",disabled:!0,disableClear:!0},model:{value:e.timePicker.viewDate,callback:function(t){e.$set(e.timePicker,"viewDate",t)},expression:"timePicker.viewDate"}})],1),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:!e.showOrHide.isHardwareProducts,expression:"!showOrHide.isHardwareProducts"}],staticClass:"border_price",class:{m_t15:e.showOrHide.existPurchaseTime&&!e.showOrHide.isHardwareProducts},attrs:{id:"price"}},[r("mt-field",{attrs:{label:"购机价格(元):",placeholder:"请输入购机价格",type:"tel"},model:{value:e.purchasePrice,callback:function(t){e.purchasePrice=t},expression:"purchasePrice"}})],1),e._v(" "),r("div",{staticClass:"overflow_y"},[e.serviceOptionItem.showList?r("div",{staticClass:"null_data"},[r("div",{staticClass:"null"}),e._v(" "),r("p",[e._v("暂无符合条件的产品服务")])]):r("div",{staticClass:"product_list",attrs:{id:"option"}},e._l(e.serviceOptionItem.list,function(t){return r("div",{staticClass:"item_container "},[r("div",{staticClass:"mt-10"},[r("div",{staticClass:"item_container"},[r("div",{staticClass:"item_p"},[r("div",{staticClass:"item_img"},[r("img",{attrs:{src:t.imageUrl}})]),e._v(" "),r("div",{staticClass:"item_content"},[r("p",{staticClass:"productName"},[e._v(e._s(t.name))]),e._v(" "),r("p",[r("span",{staticClass:"item_font12 item_color"},[e._v(e._s(t.unitPrice)+"元")]),r("s",{staticClass:"delete_price"},[e._v(e._s(t.unitPrice+100)+"元")])])]),e._v(" "),r("label",{staticClass:"pay-label"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.checkValue,expression:"checkValue"}],staticClass:"pay-radio",attrs:{type:"radio",name:"pay-radio",checked:"true"},domProps:{value:t,checked:e._q(e.checkValue,t)},on:{change:function(r){e.checkValue=t}}}),e._v(" "),r("span",{staticClass:"pay-radioInput"})])])])])])}))]),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.showOrHide.existPurchaseTime&&!e.showOrHide.isHardwareProducts,expression:"showOrHide.existPurchaseTime && !showOrHide.isHardwareProducts"}],on:{touchmove:function(e){e.preventDefault()}}},[r("mt-datetime-picker",{ref:"picker",staticClass:"timePicker",attrs:{"lock-scroll":"true",type:"date",endDate:e.timePicker.maxDate,"year-format":"{value} "},on:{confirm:e.handleConfirm},model:{value:e.timePicker.pickerValue,callback:function(t){e.$set(e.timePicker,"pickerValue",t)},expression:"timePicker.pickerValue"}})],1),e._v(" "),r("div",{staticClass:"remarks"},[r("div",{staticClass:"header",attrs:{id:"lift"}},[e._v("用户及设备信息")]),e._v(" "),r("div",{staticClass:"container"},[r("mt-field",{attrs:{label:"姓名",placeholder:"请输入客户姓名",disableClear:!0},model:{value:e.customerName,callback:function(t){e.customerName=t},expression:"customerName"}})],1),e._v(" "),r("div",{staticClass:"container"},[r("mt-field",{attrs:{label:"手机",placeholder:"请输入客户手机号码",type:"tel",disableClear:!0},model:{value:e.phoneNumber,callback:function(t){e.phoneNumber=t},expression:"phoneNumber"}})],1),e._v(" "),r("div",[r("div",{staticClass:"container"},[r("div",{staticClass:"container_c",class:{placeholder:e.isCategoryPlaceholder}},[r("div",{staticClass:"content"},[r("mt-cell",{attrs:{title:"品类",value:e.orderFilling.category.value.categoryName}})],1)])]),e._v(" "),r("div",{staticClass:"container",on:{click:function(t){e.goToPageBrand()}}},[r("div",{staticClass:"container_c",class:{placeholder:e.isBrandPlaceholder}},[r("div",{staticClass:"content",class:{select:"请选择品牌"===e.orderFilling.brand.value.brandName}},[r("mt-cell",{attrs:{title:"品牌",value:e.orderFilling.brand.value.brandName}})],1),e._v(" "),r("span",{staticClass:"link"})])]),e._v(" "),e._l(e.expand.otherExpand,function(t){return r("div",{staticClass:"container"},[5===t.contentTypeCode?r("div",{staticClass:"geography"},[r("div",{staticClass:"container",class:{address:""!==e.address.province.name},on:{click:function(t){e.provincePicker.show=e.expand.showLocation}}},[r("mt-field",{attrs:{label:"省",placeholder:"请选择省",disabled:!0},model:{value:e.address.province.name,callback:function(t){e.$set(e.address.province,"name",t)},expression:"address.province.name"}})],1),e._v(" "),r("mt-popup",{staticClass:"upimg-popup",attrs:{position:"bottom","lock-scroll":"true",closeOnClickModal:!1},model:{value:e.provincePicker.show,callback:function(t){e.$set(e.provincePicker,"show",t)},expression:"provincePicker.show"}},[r("div",{on:{touchmove:function(e){e.preventDefault()}}},[r("div",{staticClass:"popup-top clear_button"},[r("mt-button",{staticClass:"popup-button cancel",attrs:{type:"primary",size:"small"},on:{click:function(t){e.provincePicker.show=!1}}},[e._v("取消\n                ")]),e._v(" "),r("mt-button",{staticClass:"popup-button",attrs:{type:"primary",size:"small"},on:{click:function(t){e.chooseProvince()}}},[e._v("确定")])],1),e._v(" "),r("mt-picker",{ref:"provincePickerObject",refInFor:!0,attrs:{slots:e.provincePicker.slot,"value-key":"name"}})],1)]),e._v(" "),r("div",{staticClass:"container",class:{address:""!==e.address.city.name},on:{click:function(t){e.cityPicker.show=e.expand.showLocation}}},[r("mt-field",{attrs:{label:"市",placeholder:"请选择市",disabled:!0},model:{value:e.address.city.name,callback:function(t){e.$set(e.address.city,"name",t)},expression:"address.city.name"}})],1),e._v(" "),r("mt-popup",{staticClass:"upimg-popup",attrs:{position:"bottom","lock-scroll":"true",closeOnClickModal:!1},model:{value:e.cityPicker.show,callback:function(t){e.$set(e.cityPicker,"show",t)},expression:"cityPicker.show"}},[r("div",{on:{touchmove:function(e){e.preventDefault()}}},[r("div",{staticClass:"popup-top clear_button"},[r("mt-button",{staticClass:"popup-button cancel",attrs:{type:"primary",size:"small"},on:{click:function(t){e.cityPicker.show=!1}}},[e._v("\n                  取消\n                ")]),e._v(" "),r("mt-button",{staticClass:"popup-button",attrs:{type:"primary",size:"small"},on:{click:function(t){e.chooseCity()}}},[e._v("确定")])],1),e._v(" "),r("mt-picker",{ref:"cityPickerObject",refInFor:!0,attrs:{slots:e.cityPicker.slot,"value-key":"name"}})],1)]),e._v(" "),r("div",{staticClass:"container",class:{address:""!==e.address.county.name},on:{click:function(t){e.countyPicker.show=e.expand.showLocation}}},[r("mt-field",{attrs:{label:"县",placeholder:"请选择县",disabled:!0},model:{value:e.address.county.name,callback:function(t){e.$set(e.address.county,"name",t)},expression:"address.county.name"}})],1),e._v(" "),r("mt-popup",{staticClass:"upimg-popup",attrs:{position:"bottom","lock-scroll":"true",closeOnClickModal:!1},model:{value:e.countyPicker.show,callback:function(t){e.$set(e.countyPicker,"show",t)},expression:"countyPicker.show"}},[r("div",{on:{touchmove:function(e){e.preventDefault()}}},[r("div",{staticClass:"popup-top clear_button"},[r("mt-button",{staticClass:"popup-button cancel",attrs:{type:"primary",size:"small"},on:{click:function(t){e.countyPicker.show=!1}}},[e._v("\n                  取消\n                ")]),e._v(" "),r("mt-button",{staticClass:"popup-button",attrs:{type:"primary",size:"small"},on:{click:function(t){e.chooseCounty()}}},[e._v("确定")])],1),e._v(" "),r("mt-picker",{ref:"countyPickerObject",refInFor:!0,attrs:{slots:e.countyPicker.slot,"value-key":"name"}})],1)]),e._v(" "),r("mt-field",{attrs:{readonly:!e.expand.showLocation,label:"详细地址",placeholder:"请输入详细地址",type:"textarea",rows:"2",disableClear:!0},model:{value:e.address.desc,callback:function(t){e.$set(e.address,"desc",t)},expression:"address.desc"}})],1):r("div",[r("mt-field",{attrs:{label:t.name,placeholder:t.describe,disableClear:!0,disabled:!e.remarksFlag},model:{value:t.value,callback:function(r){e.$set(t,"value",r)},expression:"item.value"}},[4===t.contentTypeCode?r("span",{staticClass:"scan_icon",on:{click:function(r){e.scanQRCode(t.id)}}},[r("img",{attrs:{src:"/static/we-icon.png"}})]):e._e()])],1)])}),e._v(" "),r("div",{staticClass:"img_container",class:{disabled:!e.remarksFlag}},e._l(e.expand.imageExpand,function(t){return r("div",{staticClass:"pic"},[r("div",{staticClass:"img",on:{click:function(r){e.chooseImage(t.id)}}},[r("img",{directives:[{name:"show",rawName:"v-show",value:t.src,expression:"item.src"}],attrs:{src:t.src}})]),e._v(" "),r("p",{staticClass:"title"},[e._v(e._s(t.name))])])}))],2)]),e._v(" "),r("div",{staticClass:"height_40",class:{height_100:e.licenceId&&e.remarksFlag}}),e._v(" "),r("div",{staticClass:"fixButton footer",class:{pt_8:e.licenceId&&e.remarksFlag}},[r("div",{directives:[{name:"show",rawName:"v-show",value:e.licenceId&&e.remarksFlag,expression:"licenceId && remarksFlag"}],staticClass:"p_r15 clear"},[r("label",{staticClass:"f-l"},[r("input",{directives:[{name:"model",rawName:"v-model",value:e.agreeChecked,expression:"agreeChecked"}],staticClass:"pay-radio",attrs:{type:"radio",name:"licence",value:"true",checked:"true"},domProps:{checked:e._q(e.agreeChecked,"true")},on:{click:function(t){e.inputType()},change:function(t){e.agreeChecked="true"}}}),e._v(" "),r("span",{staticClass:"pay-radioInput m-0"})]),e._v(" "),r("span",{staticClass:"agreeClause"},[e._v("本人承诺上述信息的真实性，理解并同意"),r("span",{staticClass:"item_button item_color_02",on:{click:function(t){t.stopPropagation(),e.goToPageLicence()}}},[e._v("《服务条款》")]),e._v("的全部内容")])]),e._v(" "),r("div",{staticClass:"w_90",class:{mt_5:e.licenceId&&e.remarksFlag}},[e.remarksFlag?r("span",{staticClass:"price_buy"},[e._v("￥"+e._s(e.checkValue.unitPrice))]):r("span",{staticClass:"color_5"},[e._v("--")]),e._v(" "),r("mt-button",{staticClass:"buttonBuy",attrs:{size:"normal",type:"primary"},on:{click:function(t){e.submitOrder()}}},[e._v("立即购买")])],1)])])},staticRenderFns:[]},n=function(e){r("lSig")},c=r("VU/8")(i.a,s,!1,n,"data-v-15727772",null);t.default=c.exports},e5fO:function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var i=a(r("BO1k")),s=a(r("woOf")),n=a(r("mvHQ")),c=a(r("Xxa5")),o=a(r("exGp")),d=a(r("3D1+")),u=a(r("PJh5")),l=a(r("M4fF")),p=r("JaHG"),h=r("Au9i"),f=a(r("fxnj"));t.default={name:"haoBaiSellProduct",data:function(){return{customerName:window.localStorage.getItem("customerName")||"",phoneNumber:window.localStorage.getItem("phoneNumber")||"",loadInfo:!0,licenceId:"",agreeChecked:window.localStorage.getItem("agreeChecked")||"",checkValue:{},radioFlag:!1,remarksFlag:!1,showOrHide:{existPurchaseTime:"",isHardwareProducts:!0},params:{servicePackId:null,storeId:null,projectId:null},timePicker:{pickerValue:(0,u.default)().toDate(),viewDate:null,purchaseTime:null,maxDate:(0,u.default)().toDate()},purchasePrice:"",serviceOptionItem:{list:[],showList:!1},ifSubmit:!0,orderId:null,orderFilling:{},orderDetail:{},expand:{submitImage:!1,showLocation:!1,confirm:!1,imageExpand:[],timeExpand:[],otherExpand:[],expands:[]},provincePicker:{value:"",slot:[{flex:1,values:[],className:"province",textAlign:"center"}],show:!1},cityPicker:{value:"",slot:[{flex:1,values:[],className:"city",textAlign:"center"}],show:!1},countyPicker:{value:"",slot:[{flex:1,values:[],className:"county",textAlign:"center"}],show:!1},address:{desc:"",province:{geographyType:0,id:null,name:""},city:{geographyType:1,id:null,name:""},county:{geographyType:2,id:null,name:""}},data:{orderId:"",brandId:"",categoryId:"",customerName:"",customerPhone:"",expandData:[],purchasePrice:"",remark:"",serviceOptionItemId:""}}},created:function(){var e=(0,o.default)(c.default.mark(function e(){return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.params.servicePackId=this.$route.query.servicePackId,this.params.storeId=this.$route.query.storeId,this.params.projectId=this.$route.query.projectId,this.orderDetail=window.localStorage.getItem("orderDetail")?JSON.parse(window.localStorage.getItem("orderDetail")):{},l.default.isEmpty(this.orderDetail)?this.initOrder():this.orderId=this.orderDetail.orderId,this.getOrderFillingData(),this.purchasePrice=this.orderFilling.purchasePrice,this.timePicker.viewDate=this.orderFilling.viewDate,this.timePicker.purchaseTime=this.orderFilling.purchaseTime,e.next=11,this.loadHardwareProduct();case 11:this.agreeChecked=window.localStorage.getItem("agreeChecked");case 12:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),mounted:function(){var e=(0,o.default)(c.default.mark(function e(){return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.config();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),beforeRouteLeave:function(e,t,r){this.setOrderDetail(),this.setOrderFilling(),r()},methods:{inputType:function(){this.agreeChecked=!0,window.localStorage.setItem("agreeChecked",(0,n.default)(this.agreeChecked))},setOrderDetail:function(){window.localStorage.setItem("orderDetail",(0,n.default)(this.orderDetail))},setOrderFilling:function(){var e={viewDate:this.timePicker.viewDate,purchasePrice:this.purchasePrice,purchaseTime:this.timePicker.purchaseTime},t=!0,r=!1,a=void 0;try{for(var c,o=(0,i.default)(this.expand.expands);!(t=(c=o.next()).done);t=!0){var d=c.value;5===d.contentTypeCode&&(d.value=(0,n.default)({addressDescription:this.address.desc,city:this.address.city.name,cityId:this.address.city.id,county:this.address.county.name,countyId:this.address.county.id,province:this.address.province.name,provinceId:this.address.province.id}))}}catch(e){r=!0,a=e}finally{try{!t&&o.return&&o.return()}finally{if(r)throw a}}var u=JSON.parse((0,n.default)(this.orderFilling));(0,s.default)(u,e),u.expand=this.expand.expands,window.localStorage.setItem("orderFilling",(0,n.default)(u))},initOrder:function(){window.localStorage.setItem("orderDetail",(0,n.default)({})),window.localStorage.setItem("orderFilling",(0,n.default)({category:{value:{categoryName:"手机",categoryId:null},categoryList:[],isJumpingCategory:null},brand:{value:{brandName:"请选择品牌",brandId:null},brandList:[],isJumpingBrand:null},expand:[{contentTypeCode:3,describe:"请上传显示IMEI屏幕照片",name:"上传显示IMEI的屏幕照片"},{contentTypeCode:3,describe:"请上传购机发票照片",name:"上传购机发票照片"},{contentTypeCode:0,describe:"请输入手机型号",name:"手机型号"},{contentTypeCode:0,describe:"请输入IMEI",name:"IMEI"},{contentTypeCode:0,describe:"请输入发票编号",name:"发票编号"}],service:{serviceItemName:null,unitPrice:null,serviceOptionItemId:null,servicePackId:null},viewDate:null,purchaseTime:null,purchasePrice:""}))},amendOrder:function(){var e=(0,o.default)(c.default.mark(function e(t){var r,a=this;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.initOrder(),this.orderDetail={},this.orderFilling=JSON.parse(window.localStorage.getItem("orderFilling")),r={purchasePrice:this.purchasePrice,purchaseTime:this.timePicker.viewDate,serviceOptionItemId:t},e.next=6,(0,p.loadData)(function(){return d.default.reviseOrder(a.orderId,r)},function(){},p.defaultPreHandler,!1);case 6:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),getOrderId:function(){var e=(0,o.default)(c.default.mark(function e(t){var r,a=this;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this.orderId){e.next=7;break}return e.next=3,this.saveOrder(t);case 3:r=e.sent,this.orderId=r.orderId,e.next=11;break;case 7:if(this.loadInfo=!!l.default.isEmpty(this.orderDetail)||t!==this.orderDetail.orderItemDtos[0].serviceOptionItem.serviceOptionItemId,!this.loadInfo){e.next=11;break}return e.next=11,this.amendOrder(t);case 11:return e.next=13,(0,p.loadData)(function(){return a.load()});case 13:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),addTitle:function(){if(1!==document.getElementsByClassName("datetime_title").length){document.getElementsByClassName("picker-toolbar")[0].insertAdjacentHTML("beforeBegin",'<div class="datetime_title">请选择购机日期</div>')}},loadHardwareProduct:function(){var e=(0,o.default)(c.default.mark(function e(){var t=this;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.loadData)(function(){return d.default.getServicePack(t.params.servicePackId)},function(e){t.showOrHide.existPurchaseTime=e.existPurchaseTime,t.showOrHide.isHardwareProducts=e.isHardwareProducts,!0===t.showOrHide.isHardwareProducts&&t.getServiceOptionItems()},p.defaultPreHandler,!0);case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),executeLoadingProducts:l.default.debounce((0,o.default)(c.default.mark(function e(){var t=this;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.timePicker.purchaseTime&&this.purchasePrice||!this.showOrHide.isHardwareProducts&&!this.showOrHide.existPurchaseTime)){e.next=6;break}return e.next=3,this.getServiceOptionItems();case 3:""===this.purchasePrice&&(this.serviceOptionItem.list=[],this.serviceOptionItem.showList=!1),e.next=14;break;case 6:if(!this.orderId){e.next=12;break}return this.amendOrder(this.checkValue.serviceOptionItemId),e.next=10,(0,p.loadData)(function(){return t.load()});case 10:e.next=14;break;case 12:this.serviceOptionItem.list=[],this.serviceOptionItem.showList=!1;case 14:case"end":return e.stop()}},e,this)})),300),openPicker:function(){this.addTitle(),this.timePicker.purchaseTime&&(this.timePicker.pickerValue=(0,u.default)(this.timePicker.purchaseTime).toDate()),this.$refs.picker.open()},setDate:function(e){this.timePicker.viewDate=(0,u.default)(e).format("YYYY 年 MM 月 DD 日"),this.timePicker.purchaseTime=(0,u.default)(e).format("YYYY/MM/DD")},getServiceOptionItems:function(){var e=(0,o.default)(c.default.mark(function e(){var t,r=this;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!/^[0-9]+(.[0-9]{1,2})?$/.test(this.purchasePrice)&&this.purchasePrice){e.next=6;break}return t={servicePackId:this.params.servicePackId,purchasePrice:this.purchasePrice,purchaseTime:this.timePicker.purchaseTime},e.next=5,(0,p.loadData)(function(){return d.default.getServiceOptionItems(t)},function(){var e=(0,o.default)(c.default.mark(function e(a){return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l.default.forEach(a,function(e){0===e.salesTimes&&(e.salesTimes=1);var t=e.salesBaseValue+e.salesCount*e.salesTimes;e.sale=l.default.padStart(t.toString(),6,"0")}),r.purchasePrice!==t.purchasePrice){e.next=9;break}r.serviceOptionItem.list=a,r.remarksFlag=a.length>0&&!l.default.isEmpty(r.checkValue),r.expand.showLocation=r.remarksFlag,0===a.length?(r.initOrder(),r.orderDetail={},r.orderFilling=JSON.parse(window.localStorage.getItem("orderFilling"))):1===a.length&&(r.checkValue=a[0]),r.serviceOptionItem.showList=0===r.serviceOptionItem.list.length,e.next=11;break;case 9:return e.next=11,r.getServiceOptionItems();case 11:case"end":return e.stop()}},e,r)}));return function(t){return e.apply(this,arguments)}}(),p.defaultPreHandler);case 5:l.default.isEmpty(this.orderDetail)||(this.checkValue=l.default.find(this.serviceOptionItem.list,function(e){return e.serviceOptionItemId===r.orderDetail.orderItemDtos[0].serviceOptionItem.serviceOptionItemId}));case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),handleConfirm:function(e){this.setDate(e),document.getElementById("price").getElementsByTagName("input")[0].focus()},goToPageLicence:function(){this.$router.push({name:"Licence",query:{licenceId:this.licenceId}})},saveOrder:function(){var e=(0,o.default)(c.default.mark(function e(t){var r,a;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=void 0,a={storeId:this.params.storeId,projectId:this.params.projectId,personId:this.$store.state.person.personId,purchasePrice:this.purchasePrice,purchaseTime:this.timePicker.purchaseTime,serviceOptionItemId:t},e.next=4,(0,p.loadData)(function(){return d.default.getSaveOrder(a)},function(e){r=e},p.defaultPreHandler);case 4:return e.abrupt("return",r);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),load:function(){var e=(0,o.default)(c.default.mark(function e(){return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getOrderFillingData();case 2:return e.next=4,this.getCategoryList();case 4:return e.next=6,this.getBrandList();case 6:return e.next=8,this.getExpand();case 8:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),config:function(){var e=(0,o.default)(c.default.mark(function e(){var t,r;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=location.href.split("#")[0],r=window.localStorage.getItem("agentId"),e.next=4,this.$initWxConfig(t,["chooseImage","getLocalImgData","uploadImage","scanQRCode","getLocation"],r);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),loadOrderDetail:function(){var e=(0,o.default)(c.default.mark(function e(){var t=this;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.orderId){e.next=3;break}return e.next=3,(0,p.loadData)(function(){return d.default.getOrderDetail(t.orderId)},function(e){t.orderDetail=e},p.defaultPreHandler,!0);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getOrderFillingData:function(){var e=(0,o.default)(c.default.mark(function e(){var t,r;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.orderFilling=JSON.parse(window.localStorage.getItem("orderFilling")),!l.default.isEmpty(this.orderDetail)){e.next=6;break}return e.next=4,this.loadOrderDetail();case 4:e.next=9;break;case 6:this.orderFilling.service={serviceItemName:this.orderDetail.orderItemDtos[0].serviceOptionItem.name,unitPrice:this.orderDetail.orderItemDtos[0].serviceOptionItem.unitPrice,serviceOptionItemId:this.orderDetail.orderItemDtos[0].serviceOptionItem.serviceOptionItemId,servicePackId:this.orderDetail.orderItemDtos[0].servicePackDto.servicePackId},this.orderFilling.purchaseTime=this.orderDetail.orderItemDtos[0].customerDeviceDto.purchaseTime,this.orderFilling.purchasePrice=this.orderDetail.orderItemDtos[0].customerDeviceDto.purchasePrice;case 9:this.orderFilling.purchaseTime&&(this.orderFilling.purchaseTime=(0,u.default)(this.orderFilling.purchaseTime).format("YYYY-MM-DD")),this.expand.expands=this.orderFilling.expand,this.expand.otherExpand=this.expand.expands.filter(function(e){return 1!==e.contentTypeCode&&3!==e.contentTypeCode}),this.expand.timeExpand=this.expand.expands.filter(function(e){return 1===e.contentTypeCode}),this.expand.imageExpand=this.expand.expands.filter(function(e){return 3===e.contentTypeCode}),(t=this.expand.expands.filter(function(e){return 5===e.contentTypeCode})).length>0&&t[0].value&&(r=JSON.parse(t[0].value),this.address.desc=r.addressDescription,this.address.city.name=r.city,this.address.city.id=r.cityId,this.address.county.name=r.county,this.address.county.id=r.countyId,this.address.province.name=r.province,this.address.province.id=r.provinceId);case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getCategoryList:function(){var e=(0,o.default)(c.default.mark(function e(){var t=this;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.loadInfo){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,(0,p.loadData)(function(){return d.default.getCategories(t.orderId)},function(e){t.orderFilling.category.value=e[0],t.orderFilling.category.isJumpingCategory=!1,t.orderFilling.category.categoryList=e},p.defaultPreHandler,!0);case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getBrandList:function(){var e=(0,o.default)(c.default.mark(function e(){var t,r=this;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.loadInfo){e.next=5;break}if(t={orderId:this.orderId,categoryId:this.orderFilling.category.value.categoryId,name:"",page:1},!this.orderFilling.category.value.categoryId||this.orderFilling.brand.value.brandId){e.next=5;break}return e.next=5,(0,p.loadData)(function(){return d.default.getBrands(t)},function(e){r.orderFilling.brand.brandList=e},p.defaultPreHandler,!0);case 5:1===this.orderFilling.brand.brandList.length?(this.orderFilling.brand.value=this.orderFilling.brand.brandList[0],this.orderFilling.brand.isJumpingBrand=!1):this.orderFilling.brand.isJumpingBrand=!0;case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),getExpand:function(){var e=(0,o.default)(c.default.mark(function e(){var t,r,a=this;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.loadInfo){e.next=5;break}return t={servicePackId:this.$route.query.servicePackId,categoryId:this.orderFilling.category.value.categoryId},e.next=4,(0,p.loadData)(function(){return d.default.getObjectExpands(t)},function(e){a.expand.expands=e},p.defaultPreHandler,!0);case 4:l.default.forEach(this.expand.expands,function(e){e.isNull?e.state="success":e.state="default",(0,s.default)(e,{value:null})});case 5:if(this.expand.otherExpand=this.expand.expands.filter(function(e){return 1!==e.contentTypeCode&&3!==e.contentTypeCode}),this.expand.timeExpand=this.expand.expands.filter(function(e){return 1===e.contentTypeCode}),this.expand.timeExpand&&this.expand.timeExpand.length>0&&(this.orderFilling.purchaseTime?this.expand.timeExpand[0].value=this.orderFilling.purchaseTime:this.orderFilling.purchaseTime=this.expand.timeExpand[0].value),this.expand.imageExpand=this.expand.expands.filter(function(e){return 3===e.contentTypeCode}),r=this.expand.expands.filter(function(e){return 5===e.contentTypeCode}),this.expand.showLocation=!!(r.length>0&&r[0].value),!(r.length>0)||r[0].value){e.next=14;break}return e.next=14,this.fixPosition();case 14:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),fixPosition:function(){var e=(0,o.default)(c.default.mark(function e(){var t,r,a;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=navigator.userAgent,!!t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)?(r=this,f.default.getLocation({type:"wgs84",success:function(){var e=(0,o.default)(c.default.mark(function e(t){return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.loadData)(function(){return d.default.geocode(t.latitude,t.longitude,3)},function(e){e&&(r.address.province.id=e.provinceId,r.address.city.id=e.cityId,r.address.county.id=e.districtId,r.address.desc=e.street),r.expand.showLocation=!0},p.defaultPreHandler,!0);case 2:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),fail:function(){r.toast("获取不到位置信息"),r.expand.showLocation=!0},cancel:function(){r.expand.showLocation=!0}})):navigator.geolocation&&(a={timeout:3e3,maximumAge:0},navigator.geolocation.getCurrentPosition(this.geoSuccess,this.geoError,a));case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),geoSuccess:function(){var e=(0,o.default)(c.default.mark(function e(t){var r=this;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.loadData)(function(){return d.default.geocode(t.coords.latitude,t.coords.longitude,3)},function(e){e&&(r.address.province.id=e.provinceId,r.address.city.id=e.cityId,r.address.county.id=e.districtId,r.address.desc=e.street)},p.defaultPreHandler,!0);case 2:this.expand.showLocation=!0;case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),geoError:function(e){switch(e.code){case e.POSITION_UNAVAILABLE:case e.TIMEOUT:this.toast("获取不到位置信息");break;case e.UNKNOWN_ERROR:this.toast("未知错误")}this.expand.showLocation=!0},setPickerDefaultIndex:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"id",a=e.getSlotValues(0).find(function(e){return e[r]===t});a&&e.setSlotValue(0,a)},getGeography:function(){var e=(0,o.default)(c.default.mark(function e(t){var r,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r={geographyType:i,parentId:a},e.next=3,(0,p.loadData)(function(){return d.default.getGeography(r)},function(e){t.setSlotValues(0,e.geographyDtos)},p.defaultPreHandler,!0);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),chooseProvince:function(){var e=(0,o.default)(c.default.mark(function e(){var t;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.$refs.provincePickerObject[0],this.address.province=t.getValues()[0],this.provincePicker.show=!1,this.cityPicker.show=!0;case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),chooseCity:function(){var e=(0,o.default)(c.default.mark(function e(){var t;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.$refs.cityPickerObject[0],this.address.city=t.getValues()[0],this.cityPicker.show=!1,this.countyPicker.show=!0;case 4:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),chooseCounty:function(){var e=this.$refs.countyPickerObject[0];this.address.county=e.getSlotValue(0),this.countyPicker.show=!1},goToPageBrand:function(){this.orderFilling.category.value.categoryId&&this.orderFilling.brand.isJumpingBrand&&this.remarksFlag&&this.$router.push({name:"hbSelectBrand",query:{category:this.orderFilling.category.value.categoryId,orderId:this.orderId,projectId:this.orderDetail.projectId}})},scanQRCode:function(e){var t=this,r=l.default.findIndex(this.expand.otherExpand,{id:e});f.default.scanQRCode({desc:"scanQRCode desc",needResult:1,scanType:["qrCode","barCode"],success:function(e){var a=e.resultStr,i=e.resultStr.indexOf(",")+1;a=a.slice(i),t.expand.otherExpand[r].value=a,t.$set(t.expand.otherExpand,r,t.expand.otherExpand[r])},error:function(e){e.errMsg.indexOf("function_not_exist")>0&&alert("版本过低请升级")}})},chooseImage:function(e){var t=this;this.expand.submitImage=!0;var r=l.default.findIndex(this.expand.imageExpand,{id:e});f.default.chooseImage({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:function(){var e=(0,o.default)(c.default.mark(function e(a){return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.$set(t.expand.imageExpand[r],"src",a.localIds[0]),t.$set(t.expand.imageExpand[r],"save",!0),t.uploadImage(r,a.localIds[0]);case 3:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),fail:function(){t.expand.submitImage=!1},cancel:function(){t.expand.submitImage=!1}})},getLocalImageDate:function(e,t){var r=this;f.default.getLocalImgData({localId:t,success:function(t){var a=t.localData;r.$set(r.expand.imageExpand[e],"src",a)}})},uploadImage:function(e,t){var r=this;f.default.uploadImage({localId:t,isShowProgressTips:1,success:function(a){r.expand.imageExpand[e].value=a.serverId;!!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)&&r.getLocalImageDate(e,t),r.expand.submitImage=!1},fail:function(){this.toast("图片上传失败，请重试"),r.expand.submitImage=!1}})},confirmExpands:function(){var e=this,t=this.expand.expands.filter(function(e){return!e.isNull}),r=t.filter(function(e){return""!==e.regex}),a=l.default.filter(t,{regex:""});return l.default.forEach(a,function(e){e.value?e.state="success":e.state="default"}),l.default.forEach(r,function(t){var r=new RegExp(t.regex,"i");if(t.value){var a=r.test(t.value);t.state=a?"success":"default"}else t.state="default";if(1===t.contentTypeCode&&t.value){var i=(0,u.default)(t.value).toDate(),s=e.orderDetail.submitTime,n=(0,u.default)(s).toDate();parseInt((n-i)/1e3/60/60/24)>t.regex?t.state="default":t.state="success"}}),this.expand.expands.find(function(e){return"default"===e.state})},toast:function(e){(0,h.Toast)({message:e,position:"middle",duration:2e3})},confirm:function(){this.expand.confirm=!1;var e=this.confirmExpands(),t=this.expand.expands.find(function(e){return 5===e.contentTypeCode});if(t&&(t=!t.isNull),!this.showOrHide.existPurchaseTime||this.showOrHide.isHardwareProducts||this.timePicker.viewDate)if(this.showOrHide.isHardwareProducts||this.purchasePrice)if(l.default.isEmpty(this.checkValue))this.toast("请选择服务产品");else if(/^([A-Za-z\u4e00-\u9fa5]{2,14})$/.test(this.customerName))if(/^(86)*0*1\d{10}$/.test(this.phoneNumber))if(this.orderFilling.category.value.categoryId)if(this.orderFilling.brand.value.brandId)if(t&&!this.address.province.id)this.toast("请选择省");else if(t&&!this.address.city.id)this.toast("请选择市");else if(t&&!this.address.county.id)this.toast("请选择县");else if(t&&""===this.address.desc)this.toast("请输入详细地址");else if(this.agreeChecked)if(e){var r=void 0;r=""===e.regexMsg?e.name+"不可为空":e.regexMsg,this.toast(r)}else this.expand.confirm=!0;else this.toast("请勾选服务条款");else this.toast("请选择品牌");else this.toast("请选择品类");else this.toast("请输入11位手机号");else this.toast("请输入正确的客户姓名");else this.toast("请输入购机金额");else this.toast("请选择购机日期")},postData:function(){var e=(0,o.default)(c.default.mark(function e(){var t,r,a,s,n,o,u=this;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=!0,r=!1,a=void 0,e.prev=3,s=c.default.mark(function e(){var t;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(3!==(t=o.value).contentTypeCode||!t.save){e.next=4;break}return e.next=4,(0,p.loadData)(function(){return d.default.getImage(t.value,20)},function(e){t.value=e.id},p.defaultPreHandler,!0);case 4:case"end":return e.stop()}},e,u)}),n=(0,i.default)(this.expand.expands);case 6:if(t=(o=n.next()).done){e.next=11;break}return e.delegateYield(s(),"t0",8);case 8:t=!0,e.next=6;break;case 11:e.next=17;break;case 13:e.prev=13,e.t1=e.catch(3),r=!0,a=e.t1;case 17:e.prev=17,e.prev=18,!t&&n.return&&n.return();case 20:if(e.prev=20,!r){e.next=23;break}throw a;case 23:return e.finish(20);case 24:return e.finish(17);case 25:return this.setFillingData(),e.next=28,(0,p.loadData)(function(){return d.default.postOrder(u.data)},function(e){e?(u.initOrder(),u.$router.push({name:"BaiPay",query:{orderId:u.orderDetail.orderId}})):u.ifSubmit=!0},p.boolPreHandler);case 28:case"end":return e.stop()}},e,this,[[3,13,17,25],[18,,20,24]])}));return function(){return e.apply(this,arguments)}}(),submitOrder:function(){var e=(0,o.default)(c.default.mark(function e(){var t,r,a,s,o,d,u=this;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.expand.submitImage){e.next=4;break}this.toast("图片上传中，请稍候..."),e.next=27;break;case 4:for(t=!0,r=!1,a=void 0,e.prev=7,s=(0,i.default)(this.expand.expands);!(t=(o=s.next()).done);t=!0)5===(d=o.value).contentTypeCode&&(d.value=(0,n.default)({addressDescription:this.address.desc,city:this.address.city.name,cityId:this.address.city.id,county:this.address.county.name,countyId:this.address.county.id,province:this.address.province.name,provinceId:this.address.province.id}));e.next=15;break;case 11:e.prev=11,e.t0=e.catch(7),r=!0,a=e.t0;case 15:e.prev=15,e.prev=16,!t&&s.return&&s.return();case 18:if(e.prev=18,!r){e.next=21;break}throw a;case 21:return e.finish(18);case 22:return e.finish(15);case 23:if(this.confirm(),!this.expand.confirm){e.next=27;break}return e.next=27,(0,p.loadData)(function(){return u.postData()});case 27:window.localStorage.removeItem("agreeChecked");case 28:case"end":return e.stop()}},e,this,[[7,11,15,23],[16,,18,22]])}));return function(){return e.apply(this,arguments)}}(),setFillingData:function(){var e=this;this.data.orderId=this.orderId,this.data.brandId=this.orderFilling.brand.value.brandId,this.data.categoryId=this.orderFilling.category.value.categoryId,this.data.customerName=this.customerName,this.data.customerPhone=this.phoneNumber,this.data.purchasePrice=this.orderFilling.purchasePrice||"",this.data.serviceOptionItemId=this.orderFilling.service.serviceOptionItemId;var t=[],r="";l.default.forEach(this.expand.expands,function(a){var i={customerDeviceExpandId:a.id,customerDeviceExpandValue:a.value||""};1===a.contentTypeCode&&(i.customerDeviceExpandValue=e.orderFilling.purchaseTime),t.push(i);new RegExp("备注").test(a.name)&&(r=a.value||"")}),this.data.expandData=t,this.data.remark=r||""}},computed:{listScroll:function(){return this.showOrHide.existPurchaseTime&&!this.showOrHide.isHardwareProducts},listTimeScroll:function(){return!this.showOrHide.isHardwareProducts&&!this.showOrHide.existPurchaseTime},isCategoryPlaceholder:function(){return"请选择品类"===this.orderFilling.category.value.categoryName},isBrandPlaceholder:function(){return"请选择品牌"===this.orderFilling.brand.value.brandName}},watch:{customerName:function(e){window.localStorage.setItem("customerName",e)},phoneNumber:function(e){window.localStorage.setItem("phoneNumber",e)},"provincePicker.show":function(e){if(e&&!this.address.province.id){var t=this.$refs.provincePickerObject[0];0===t.getSlotValues(0).length&&this.getGeography(t)}},"cityPicker.show":function(e){e&&(this.address.province.id||(this.cityPicker.show=!1,this.toast("请先选择开户省")))},"countyPicker.show":function(e){e&&(this.address.city.id||(this.countyPicker.show=!1,this.toast("请先选择开户省市")))},"address.province.id":function(e,t){var r=this;e&&this.$nextTick((0,o.default)(c.default.mark(function a(){var i;return c.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(0!==(i=r.$refs.provincePickerObject[0]).getSlotValues(0).length||null!==t){a.next=11;break}return a.next=4,r.getGeography(i);case 4:if(r.setPickerDefaultIndex(i,e,"id"),r.address.province.name=i.getSlotValues(0).find(function(t){return t.id===e})?i.getSlotValues(0).find(function(t){return t.id===e}).name:"",r.address.city.id){a.next=9;break}return a.next=9,r.getGeography(r.$refs.cityPickerObject[0],e,1);case 9:a.next=17;break;case 11:return a.next=13,r.getGeography(r.$refs.cityPickerObject[0],e,1);case 13:r.address.city.id=null,r.address.city.name="",r.address.county.id=null,r.address.county.name="";case 17:case"end":return a.stop()}},a,r)})))},"address.city.id":function(e,t){var r=this;e&&this.$nextTick((0,o.default)(c.default.mark(function a(){var i;return c.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(0!==(i=r.$refs.cityPickerObject[0]).getSlotValues(0).length||null!==t){a.next=11;break}return a.next=4,r.getGeography(i,r.address.province.id,1);case 4:if(r.setPickerDefaultIndex(i,e,"id"),r.address.city.name=i.getSlotValues(0).find(function(t){return t.id===e})?i.getSlotValues(0).find(function(t){return t.id===e}).name:"",r.address.county.id){a.next=9;break}return a.next=9,r.getGeography(r.$refs.countyPickerObject[0],e,1);case 9:a.next=15;break;case 11:return a.next=13,r.getGeography(r.$refs.countyPickerObject[0],e,2);case 13:r.address.county.id=null,r.address.county.name="";case 15:case"end":return a.stop()}},a,r)})))},"address.county.id":function(){var e=(0,o.default)(c.default.mark(function e(t,r){var a=this;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t&&this.$nextTick((0,o.default)(c.default.mark(function e(){var i;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==(i=a.$refs.countyPickerObject[0]).getSlotValues(0).length||null!==r){e.next=6;break}return e.next=4,a.getGeography(i,a.address.city.id,2);case 4:a.setPickerDefaultIndex(i,t,"id"),a.address.county.name=i.getSlotValues(0).find(function(e){return e.id===t})?i.getSlotValues(0).find(function(e){return e.id===t}).name:"";case 6:case"end":return e.stop()}},e,a)})));case 1:case"end":return e.stop()}},e,this)}));return function(t,r){return e.apply(this,arguments)}}(),checkValue:function(e){l.default.isEmpty(e)||(this.licenceId=e.licenceId,this.remarksFlag=!!e,this.getOrderId(e.serviceOptionItemId))},"timePicker.purchaseTime":"executeLoadingProducts",purchasePrice:"executeLoadingProducts"}}},lSig:function(e,t){}});
//# sourceMappingURL=35.7314d8d2f7f797b8606a.js.map